<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BRAU ERP | Unified Affiliation & Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap');
        body { font-family: 'Roboto', sans-serif; background: #f0f2f5; }
        .brau-header { background: #002147; border-bottom: 4px solid #ffcc00; }
        .glass-card { background: white; border-radius: 12px; box-shadow: 0 8px 30px rgba(0,0,0,0.05); }
        input, select, textarea { border: 1px solid #cbd5e1; padding: 12px; border-radius: 8px; width: 100%; margin-top: 5px; font-weight: 600; }
        .sidebar-btn { width: 100%; text-align: left; padding: 12px; border-radius: 8px; font-weight: 700; font-size: 13px; margin-bottom: 4px; transition: 0.3s; }
        .sidebar-btn:hover { background: #f1f5f9; color: #002147; }
        .active-btn { background: #002147; color: white !important; }
    </style>
</head>
<body class="h-screen flex flex-col">

    <header class="brau-header text-white p-4 flex justify-between items-center no-print">
        <div class="flex items-center gap-4">
            <div class="bg-white p-2 rounded-lg text-blue-900 font-black text-xl">BRAU</div>
            <div>
                <h1 class="font-bold text-lg tracking-tight">DR. B.R. AMBEDKAR UNIVERSITY</h1>
                <p class="text-[10px] uppercase tracking-widest opacity-80">Affiliation & Academic Management System</p>
            </div>
        </div>
        <div class="flex items-center gap-6">
            <span id="timer" class="text-xs font-mono opacity-70"></span>
            <button onclick="location.reload()" class="bg-red-500 hover:bg-red-600 px-4 py-1 rounded text-[10px] font-bold uppercase">Logout</button>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <aside id="sidebar" class="w-64 bg-white border-r p-5 hidden no-print">
            <div class="mb-10 text-center border-b pb-6">
                <h3 id="displayUserName" class="font-black text-blue-900 uppercase text-sm">User</h3>
                <p id="displayUserRole" class="text-[9px] font-bold text-amber-600 uppercase tracking-widest"></p>
            </div>
            <nav id="navItems"></nav>
        </aside>

        <main class="flex-1 p-8 overflow-y-auto">
            <div id="gateway" class="max-w-4xl mx-auto mt-10">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                    <div class="glass-card p-10 border-t-8 border-blue-900">
                        <h2 class="text-2xl font-black text-blue-900 mb-6 uppercase italic">Staff/Student Login</h2>
                        <input id="uID" type="text" placeholder="Access ID">
                        <input id="uPIN" type="password" placeholder="PIN" class="mt-4">
                        <button onclick="login()" class="w-full bg-[#002147] text-white py-4 rounded-xl font-bold mt-6 uppercase tracking-widest">Login to Portal</button>
                        <p class="mt-4 text-center text-[8px] text-gray-400 font-bold uppercase">Uni: admin/0000 | Coll: college1/1234</p>
                    </div>
                    <div class="glass-card p-10 border-t-8 border-amber-500">
                        <h2 class="text-2xl font-black text-blue-900 mb-6 uppercase italic">New Affiliation</h2>
                        <p class="text-xs text-gray-500 mb-6">Want to affiliate your college with BRAU? Submit your application for review.</p>
                        <button onclick="showAffForm()" class="w-full bg-amber-500 text-blue-900 py-4 rounded-xl font-bold uppercase tracking-widest hover:bg-amber-400">Apply for Affiliation</button>
                    </div>
                </div>
            </div>

            <div id="appView" class="hidden"></div>
        </main>
    </div>

    <script>
        let currentRole = null;
        let pendingRequests = [
            { id: "APP786", name: "Ambedkar Medical College", city: "Jaipur", status: "Pending" }
        ];

        function login() {
            const id = document.getElementById('uID').value;
            const pin = document.getElementById('uPIN').value;

            if(id === 'admin' && pin === '0000') currentRole = 'UNIVERSITY';
            else if(id === 'college1' && pin === '1234') currentRole = 'COLLEGE';
            else if(id === 'std1' && pin === '111') currentRole = 'STUDENT';
            else { alert('Invalid Credentials'); return; }

            document.getElementById('gateway').classList.add('hidden');
            document.getElementById('sidebar').classList.remove('hidden');
            document.getElementById('appView').classList.remove('hidden');
            loadInterface();
        }

        function loadInterface() {
            const nav = document.getElementById('navItems');
            document.getElementById('displayUserRole').innerText = currentRole;
            document.getElementById('displayUserName').innerText = currentRole === 'UNIVERSITY' ? 'Registrar General' : 'College Administrator';

            if(currentRole === 'UNIVERSITY') {
                nav.innerHTML = `
                    <button onclick="uniDash()" class="sidebar-btn active-btn"><i class="fas fa-chart-line mr-2"></i> Dashboard</button>
                    <button onclick="uniAffiliate()" class="sidebar-btn text-amber-600"><i class="fas fa-check-circle mr-2"></i> Approve Affiliation</button>
                    <button onclick="uniGodMode()" class="sidebar-btn text-red-600"><i class="fas fa-bolt mr-2"></i> Database God Mode</button>
                `;
                uniDash();
            } else if(currentRole === 'COLLEGE') {
                nav.innerHTML = `
                    <button onclick="colAdm()" class="sidebar-btn active-btn"><i class="fas fa-user-plus mr-2"></i> New Admission</button>
                    <button onclick="colExams()" class="sidebar-btn"><i class="fas fa-file-alt mr-2"></i> Exam Forms</button>
                    <button onclick="colAdmit()" class="sidebar-btn text-blue-600"><i class="fas fa-id-card mr-2"></i> Admit Cards</button>
                `;
                colAdm();
            }
        }

        // --- UNIVERSITY: APPROVAL ENGINE ---
        function uniAffiliate() {
            let rows = pendingRequests.map(req => `
                <tr class="border-b">
                    <td class="p-4 font-bold">${req.id}</td>
                    <td class="p-4 font-bold text-blue-900">${req.name}</td>
                    <td class="p-4">${req.city}</td>
                    <td class="p-4"><span class="bg-amber-100 text-amber-700 px-3 py-1 rounded-full text-[10px] font-black">${req.status}</span></td>
                    <td class="p-4 flex gap-2">
                        <button onclick="approve('${req.id}')" class="bg-green-600 text-white px-3 py-1 rounded font-bold text-[10px]">APPROVE</button>
                        <button class="bg-red-600 text-white px-3 py-1 rounded font-bold text-[10px]">REJECT</button>
                    </td>
                </tr>`).join('');

            document.getElementById('appView').innerHTML = `
                <h2 class="text-3xl font-black mb-6 text-blue-900 italic">Affiliation Control Panel</h2>
                <div class="glass-card overflow-hidden">
                    <table class="w-full text-left">
                        <thead class="bg-gray-50 text-[10px] font-black uppercase text-gray-500">
                            <tr><th class="p-4">App ID</th><th class="p-4">College Name</th><th class="p-4">Location</th><th class="p-4">Status</th><th class="p-4">Action</th></tr>
                        </thead>
                        <tbody>${rows}</tbody>
                    </table>
                </div>`;
        }

        function approve(id) {
            alert(`College ${id} Approved! Credentials sent to their official email.`);
            pendingRequests = pendingRequests.filter(r => r.id !== id);
            uniAffiliate();
        }

        // --- COLLEGE: ADMISSION ENGINE ---
        function colAdm() {
            document.getElementById('appView').innerHTML = `
                <div class="max-w-3xl glass-card p-10 border-t-8 border-green-600">
                    <h2 class="text-2xl font-black mb-8 text-green-800 uppercase italic">Student Enrollment Portal</h2>
                    <div class="grid grid-cols-2 gap-6">
                        <div><label class="text-[10px] font-black uppercase">Faculty Selection</label>
                            <select><option>Medical Science</option><option>Paramedical</option><option>Agriculture</option></select>
                        </div>
                        <div><label class="text-[10px] font-black uppercase">Student Name</label><input type="text" placeholder="As per 10th Marksheet"></div>
                        <div><label class="text-[10px] font-black uppercase">Father's Name</label><input type="text"></div>
                        <div><label class="text-[10px] font-black uppercase">Admission Date (Normal)</label><input type="date"></div>
                    </div>
                    <button onclick="alert('Student Synchronized with University Cloud!')" class="w-full bg-green-700 text-white mt-10 py-4 rounded-xl font-black uppercase tracking-widest shadow-lg">Submit to Registrar</button>
                </div>`;
        }

        // --- PUBLIC: AFFILIATION FORM ---
        function showAffForm() {
            document.getElementById('gateway').innerHTML = `
                <div class="glass-card p-10 max-w-2xl mx-auto border-t-8 border-amber-500">
                    <h2 class="text-3xl font-black mb-6 text-blue-900 uppercase italic">College Affiliation Request</h2>
                    <div class="space-y-4">
                        <input id="newColName" placeholder="Proposed College Name">
                        <input id="newColEmail" placeholder="Official Email Address">
                        <select><option>NOC from State Govt Available</option><option>NOC Applied</option></select>
                        <textarea placeholder="Infrastructure Details (Labs, Classrooms, Library)"></textarea>
                        <button onclick="submitRequest()" class="w-full bg-amber-500 text-blue-900 py-5 rounded-2xl font-black uppercase text-xl shadow-xl">Submit Application</button>
                        <button onclick="location.reload()" class="w-full text-xs font-bold uppercase text-gray-400 mt-4">Back to Gateway</button>
                    </div>
                </div>`;
        }

        function submitRequest() {
            const name = document.getElementById('newColName').value;
            if(name) {
                pendingRequests.push({ id: "APP" + Math.floor(Math.random()*900), name: name, city: "Reviewing...", status: "Pending" });
                alert('Application Submitted Successfully! Reference ID generated.');
                location.reload();
            }
        }

        setInterval(() => { document.getElementById('timer').innerText = new Date().toLocaleString(); }, 1000);
    </script>
</body>
</html>
